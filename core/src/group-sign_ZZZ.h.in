#pragma once

#ifdef __cplusplus
extern "C" {
#endif

void* GS_createState();
void GS_destroyState(void* state);
int GS_seed(void* state, char* seed, int seed_length);
int GS_setupGroup(void* state);
int GS_loadGroupPrivKey(void* state, char* data, int len);
int GS_loadGroupPubKey(void* state, char* data, int len);
int GS_startJoin(
  void* state,
  char* challenge, // in
  int challenge_len, // in
  char* gsk, int* len_gsk, // out
  char* joinmsg, int* len // out
);
int GS_finishJoin(
  char* publickey, int len_publickey, // in
  char* gsk, int len_gsk, // in
  char* joinresponse, int len, // in
  char* credentials, int* len_credentials // out
);
int GS_loadUserPrivKey(void* state, char* in, int in_len);
int GS_exportGroupPrivKey(void* state, char* out, int* out_len);
int GS_exportGroupPubKey(void* state, char* out, int* out_len);
int GS_exportUserPrivKey(void* state, char* out, int* out_len);
int GS_processJoin(void* state, char* joinmsg, int joinmsg_len, char* challenge, int challenge_len, char* out, int* out_len);
int GS_sign(void* state, char* msg, int msg_len, char* bsn, int bsn_len, char* signature, int* len);
int GS_verify(void* state, char* msg, int msg_len, char* bsn, int bsn_len, char* signature, int len);
int GS_getSignatureTag(char* signature, int sig_len, char* tag, int* tag_len);
int GS_getStateSize();
const char* GS_version();
const char* GS_big();
const char* GS_field();
const char* GS_curve();

#ifdef __cplusplus
} // end extern "C"
#endif
